(this["webpackJsonppush-the-doors"]=this["webpackJsonppush-the-doors"]||[]).push([[0],{14:function(t,e,r){t.exports=r(22)},19:function(t,e,r){},21:function(t,e,r){},22:function(t,e,r){"use strict";r.r(e);for(var n=r(1),i=r.n(n),o=r(7),a=r.n(o),s=(r(19),r(4)),c=r.n(s),u=r(10),f=r(8),h=r(2),l=r(3),p=r(11),d=r(9),m=r(12),v=r(0),g=new Float32Array(4096),y=new Float32Array(4096),b=0;b<4096;b++){var _=Math.PI*b/2048;g[b]=Math.cos(_),y[b]=Math.sin(_)}var A={length3:function(t){var e=Object(v.e)(t,3),r=e[0],n=e[1],i=e[2];return Math.sqrt(r*r+n*n+i*i)},normalize3:function(t,e){var r=A.length3(t);e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r},length4:function(t){var e=Object(v.e)(t,4),r=e[0],n=e[1],i=e[2],o=e[3];return Math.sqrt(r*r+n*n+i*i+o*o)},normalize4:function(t,e){var r=A.length4(t);e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r}},w={cos:function(t){return g[4095&(0|t)]},sin:function(t){return y[4095&(0|t)]},clamp:function(t,e,r){return void 0===e&&(e=0),void 0===r&&(r=1),t<e?e:t>r?r:t},vector:A,matrix:{identity3:function(t){t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1},multiply3:function(t,e,r){r[0]=t[0]*e[0]+t[3]*e[1]+t[6]*e[2],r[1]=t[1]*e[0]+t[4]*e[1]+t[7]*e[2],r[2]=t[2]*e[0]+t[5]*e[1]+t[8]*e[2],r[3]=t[0]*e[3]+t[3]*e[4]+t[6]*e[5],r[4]=t[1]*e[3]+t[4]*e[4]+t[7]*e[5],r[5]=t[2]*e[3]+t[5]*e[4]+t[8]*e[5],r[6]=t[0]*e[6]+t[3]*e[7]+t[6]*e[8],r[7]=t[1]*e[6]+t[4]*e[7]+t[7]*e[8],r[8]=t[2]*e[6]+t[5]*e[7]+t[8]*e[8]},identity4:function(t){t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1}},M4_00:0,M4_10:1,M4_20:2,M4_30:3,M4_01:4,M4_11:5,M4_21:6,M4_31:7,M4_02:8,M4_12:9,M4_22:10,M4_32:11,M4_03:12,M4_13:13,M4_23:14,M4_33:15,M3_00:0,M3_10:1,M3_20:2,M3_01:3,M3_11:4,M3_21:5,M3_02:6,M3_12:7,M3_22:8},R=function(){function t(){}return t.prototype.getShaderIncludes=function(){var t=this;return{cameraUniforms:Object.keys(this.glslUniforms).map((function(e){return"uniform "+t.glslUniforms[e]+" "+e+";\n"})).join(""),cameraFunction:this.glslFunction}},t}(),E=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(v.c)(e,t),Object.defineProperty(e.prototype,"glslUniforms",{get:function(){return{}},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"glslFunction",{get:function(){return"vec4 worldPointToScreen(vec3 point) {\n    return vec4(point, 1.0);\n}"},enumerable:!0,configurable:!0}),e.prototype.setUniformValues=function(){},e}(R),T=.5*Math.PI,B={Silly:E,Perspective:function(t){function e(){var e=t.call(this)||this;return e.perspectiveMatrix=new Float32Array(16),e.fieldAngle=Math.PI/4,e.near=1,e.far=4097,e.orbit(0,0,0,1e3,0,0),e}return Object(v.c)(e,t),Object.defineProperty(e.prototype,"glslUniforms",{get:function(){return{uniCameraMatrix:"mat4",uniPerspectiveMatrix:"mat4"}},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"glslFunction",{get:function(){return"vec4 worldPointToScreen(vec3 point) {\n    return uniPerspectiveMatrix * uniCameraMatrix * vec4(point, 1.0);\n}"},enumerable:!0,configurable:!0}),e.prototype.setUniformValues=function(t,e,r){var n=this.near,i=this.far,o=this.fieldAngle,a=Math.tan(.5*(Math.PI-o)),s=1/(n-i),c=this.perspectiveMatrix;c[0]=a*r/e,c[1]=0,c[2]=0,c[3]=0,c[4]=0,c[5]=a,c[6]=0,c[7]=0,c[8]=0,c[9]=0,c[10]=(n+i)*s,c[11]=-1,c[12]=0,c[13]=0,c[14]=n*i*s*2,c[15]=0,t.uniforms.uniCameraMatrix=this.cameraMatrix,t.uniforms.uniPerspectiveMatrix=this.perspectiveMatrix},e}(function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.cameraMatrix=new Float32Array(16),e}return Object(v.c)(e,t),e.prototype.orbit=function(t,e,r,n,i,o){var a=w.clamp(i,-1.570796326794896,1.570796326794896),s=o-T,c=Math.cos(a),u=Math.sin(a),f=Math.cos(s)*c,h=u,l=Math.sin(s)*c,p=-l,d=0,m=f,v=Math.sqrt(p*p+d*d+m*m),g=l*(d/=v)-h*(m/=v),y=m*f-(p/=v)*l,b=h*p-f*d,_=-(f*n+t),A=-(h*n+e),R=-(l*n+r),E=this.cameraMatrix;E[0]=p,E[4]=d,E[8]=m,E[12]=_*p+A*d+R*m,E[1]=g,E[5]=y,E[9]=b,E[13]=_*g+A*y+R*b,E[2]=f,E[6]=h,E[10]=l,E[14]=_*f+A*h+R*l,E[3]=0,E[7]=0,E[11]=0,E[15]=1},e}(R)),Cover2D:function(t){function e(e){var r=t.call(this)||this;return r.zoom=1,r.x=0,r.y=0,r.params=Object(v.a)({size:1024},e),r}return Object(v.c)(e,t),Object.defineProperty(e.prototype,"glslUniforms",{get:function(){return{uniCameraInvertedScale:"float",uniCameraScaleX:"float",uniCameraScaleY:"float",uniCameraX:"float",uniCameraY:"float"}},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"glslFunction",{get:function(){return"vec4 worldPointToScreen(vec3 point) {\n    return vec4((point.x - uniCameraX) * uniCameraScaleX,\n                (point.y - uniCameraY) * uniCameraScaleY,\n                point.z,\n                /*uniCameraInvertedScale **/ "+(this.params.size/2).toFixed(1)+");\n}"},enumerable:!0,configurable:!0}),e.prototype.setUniformValues=function(t,e,r){e>r?(t.uniforms.uniCameraScaleX=1,t.uniforms.uniCameraScaleY=e/r):(t.uniforms.uniCameraScaleX=r/e,t.uniforms.uniCameraScaleY=1),t.uniforms.uniCameraX=this.x,t.uniforms.uniCameraY=this.y;var n=this.zoom;if(0===n)t.uniforms.uniCameraInvertedScale=1;else{var i=1/n;t.uniforms.uniCameraInvertedScale=i}},e}(R)};function x(t,e){void 0===e&&(e="");var r=typeof t;return"number"!==r||isNaN(t)?"string"===r?t:e:""+t}var O=Float32Array.BYTES_PER_ELEMENT,S=function(){function t(t,e,r){void 0===r&&(r={});var n=function(t,e){return{vert:U(t.vert,e),frag:U(t.frag,e)}}(e,r);this.gl=t,Object.freeze(this.gl),this.BPE=O,Object.freeze(this.BPE),this._typesNamesLookup=function(t){var e={};for(var r in t)if(r===r.toUpperCase()){var n=t[r];"number"===typeof n&&(e[n]=r)}return e}(t);var i=t.createProgram();if(!i)throw Error("Unable to create WebGLProgram!");this.program=i;var o=function(t,e){return M(t.VERTEX_SHADER,t,e)}(t,n.vert);t.attachShader(i,o);var a=function(t,e){return M(t.FRAGMENT_SHADER,t,e)}(t,n.frag);t.attachShader(i,a),t.linkProgram(i),this.use=function(){t.useProgram(i)},this.attribs=this.createAttributes(),this.uniforms={},this.uniformsLocation=this.createUniformsLocation()}return t.prototype.use=function(){this.gl.useProgram(this.program)},t.prototype.getTypeName=function(t){return this._typesNamesLookup[t]},t.prototype.bindAttribs=function(t){for(var e,r,n,i,o=[],a=1;a<arguments.length;a++)o[a-1]=arguments[a];var s=this,c=this.gl;c.bindBuffer(c.ARRAY_BUFFER,t);var u=0;try{for(var f=Object(v.f)(o),h=f.next();!h.done;h=f.next()){var l=h.value;if(!(y=s.attribs[l]))throw Error('Cannot find attribute "'+l+"!\nIt may be not active because unused in the shader.\nAvailable attributes are: "+Object.keys(s.attribs).map((function(t){return'"'+t+'"'})).join(", ")+" ("+String(s.attribs.length)+")");u+=y.size*y.length*O}}catch(b){e={error:b}}finally{try{h&&!h.done&&(r=f.return)&&r.call(f)}finally{if(e)throw e.error}}var p=0;try{for(var d=Object(v.f)(o),m=d.next();!m.done;m=d.next()){var g=m.value,y=s.attribs[g];c.enableVertexAttribArray(y.location),c.vertexAttribPointer(y.location,y.size*y.length,c.FLOAT,!1,u,p),p+=y.size*y.length*O}}catch(_){n={error:_}}finally{try{m&&!m.done&&(i=d.return)&&i.call(d)}finally{if(n)throw n.error}}},t.prototype.setUniform=function(t,e){var r=this.uniforms,n=this.uniformsLocation;if("undefined"===typeof n[t]){console.error('Uniform "'+t+'" does not exist in this WebGL Program!');var i=Object.keys(n);throw 0===i.length?console.error("Actually, this program has no uniform at all."):console.error("Available uniforms are:",i.join(", ")),Error('Uniform "'+t+'" was ot found!')}r[t]=e},t.prototype.createAttributes=function(){for(var t=this.gl,e=this.program,r={},n=t.getProgramParameter(e,t.ACTIVE_ATTRIBUTES),i=0;i<n;i++){var o=t.getActiveAttrib(e,i);o&&(o.typeName=this.getTypeName(o.type),o.length=this.getSize(t,o),o.location=t.getAttribLocation(e,o.name),r[o.name]=o,Object.defineProperty(this,""+o.name,{value:o.location,writable:!1,enumerable:!0,configurable:!1}))}return r},t.prototype.getSize=function(t,e){switch(e.type){case t.FLOAT_VEC4:return 4;case t.FLOAT_VEC3:return 3;case t.FLOAT_VEC2:return 2;case t.FLOAT:return 1;default:throw Error("[webgl.program:getSize] I don't know the size of the attribute \""+e.name+'" because I don\'t know the type "'+this.getTypeName(e.type)+'"!')}},t.prototype.createUniformsLocation=function(){for(var t=this.gl,e=this.program,r=this.uniforms,n={},i=t.getProgramParameter(e,t.ACTIVE_UNIFORMS),o=0;o<i;o++){var a=t.getActiveUniform(e,o);if(a){var s=P(a.name),c=t.getUniformLocation(e,a.name);c&&(n[s]=c,Object.defineProperty(r,""+s,{set:this.createUniformSetter(a,n[s],this._typesNamesLookup),get:this.createUniformGetter(a),enumerable:!0,configurable:!1}))}}return n},t.prototype.createUniformSetter=function(t,e,r){var n=this.gl,i="_"+P(t.name);switch(t.type){case n.BYTE:case n.UNSIGNED_BYTE:case n.SHORT:case n.UNSIGNED_SHORT:case n.INT:case n.UNSIGNED_INT:case n.SAMPLER_2D:return 1===t.size?function(t){n.uniform1i(e,t),this[i]=t}:function(t){n.uniform1iv(e,t),this[i]=t};case n.FLOAT:return 1===t.size?function(t){n.uniform1f(e,t),this[i]=t}:function(t){n.uniform1fv(e,t),this[i]=t};case n.FLOAT_VEC2:if(1===t.size)return function(t){n.uniform2fv(e,t),this[i]=t};throw Error("[webgl.program.createWriter] Don't know how to deal arrays of FLOAT_VEC2 in uniform \""+t.name+'"!');case n.FLOAT_VEC3:if(1===t.size)return function(t){n.uniform3fv(e,t),this[i]=t};throw Error("[webgl.program.createWriter] Don't know how to deal arrays of FLOAT_VEC3 in uniform \""+t.name+'"!');case n.FLOAT_VEC4:if(1===t.size)return function(t){n.uniform4fv(e,t),this[i]=t};throw Error("[webgl.program.createWriter] Don't know how to deal arrays of FLOAT_VEC4 in uniform \""+t.name+'"!');case n.FLOAT_MAT3:if(1===t.size)return function(t){n.uniformMatrix3fv(e,!1,t),this[i]=t};throw Error("[webgl.program.createWriter] Don't know how to deal arrays of FLOAT_MAT3 in uniform \""+t.name+'"!');case n.FLOAT_MAT4:if(1===t.size)return function(t){n.uniformMatrix4fv(e,!1,t),this[i]=t};throw Error("[webgl.program.createWriter] Don't know how to deal arrays of FLOAT_MAT4 in uniform \""+t.name+'"!');default:throw Error("[webgl.program.createWriter] Don't know how to deal with uniform \""+t.name+'" of type '+r[t.type]+"!")}},t.prototype.createUniformGetter=function(t){var e="_"+t.name;return function(){return this[e]}},t}();function U(t,e){return t.split("\n").map((function(t){if(!t.trim().startsWith("#include"))return t;var r=t.indexOf("#include")+"#include".length,n=t.substr(r).trim();"'<\"".indexOf(n.charAt(0))>-1&&(n=n.substr(1,n.length-"<>".length));var i=e[n];if("string"!==typeof i)throw console.error("Include <"+n+"> not found in ",e),Error("Include not found in shader: "+n);return i})).join("\n")}function M(t,e,r){if(t!==e.VERTEX_SHADER&&t!==e.FRAGMENT_SHADER)throw Error("Type must be VERTEX_SHADER or FRAGMENT_SHADER!");var n=e.createShader(t);if(!n)throw Error("Unable to create a "+(t===e.VERTEX_SHADER?"VERTEX":"FRAGMENT")+" shader!");if(e.shaderSource(n,r),e.compileShader(n),!e.getShaderParameter(n,e.COMPILE_STATUS)){var i=e.getShaderInfoLog(n)||"NULL";throw console.error("An error occurred compiling the shader: "+i),console.info(function(t,e){var r=t.split(/\n\r?/);r.unshift(""),j.lastIndex=-1;var n=j.exec(e);if(!n)return t;for(var i=Number(n[2]),o=Math.max(1,i-2),a=Math.min(r.length-1,i+2),s=["Here is an extract of the shader code:"],c=o;c<=a;c++)s.push("| "+c+":    "+r[c]);return s.join("\n")}(r,i)),Error("Unable to create a "+(t===e.VERTEX_SHADER?"VERTEX":"FRAGMENT")+" shader!")}return n}function P(t){var e=t.indexOf("[");return-1===e?t:t.substr(0,e)}var j=/ERROR: ([0-9]+):([0-9]+):/g;var L=function(){function t(){this._programs=[],this._scene=null}return Object.defineProperty(t.prototype,"scene",{get:function(){return this._scene},set:function(t){t!==this._scene&&(this._scene&&this.internalDestroy(this._scene),this._scene=t,t&&this.initialize(t))},enumerable:!0,configurable:!0}),t.prototype.createProgram=function(t,e){void 0===e&&(e={});var r=this._scene;if(!r)throw Error("This painter has no scene!\ncreateProfram() should only be called from initialize().");var n=new S(r.gl,t,e);return this._programs.push(n),n},t.prototype.fatal=function(t){return console.error("Fatal error in Painter:",t),new Error(t)},t.prototype.internalDestroy=function(t){var e,r,n=t.gl;try{for(var i=Object(v.f)(this._programs),o=i.next();!o.done;o=i.next()){var a=o.value;n.deleteProgram(a)}}catch(s){e={error:s}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(e)throw e.error}}},t}(),F=function(t){function e(e){var r=t.call(this)||this;return r.params=e,r}return Object(v.c)(e,t),e.prototype.render=function(){var t=this.scene,e=this.prg,r=this.atlas,n=this.buff;if(t&&e&&r&&n){var i=t.gl;i.enable(i.DEPTH_TEST),e.use(),r.activate(),e.$uniTexture=0,e.setUniform("uniAspectRatio",t.width/t.height),e.bindAttribs(n,"attXY"),i.bindBuffer(i.ARRAY_BUFFER,n),i.drawArrays(i.TRIANGLE_STRIP,0,4)}},e.prototype.destroy=function(t){var e=t.gl,r=this.buff;r&&e.deleteBuffer(r)},e.prototype.initialize=function(t){var e=this.params,r=e.atlas;this.atlas=r,this.prg=this.createProgram({frag:I,vert:C(x(e.align).toUpperCase())});var n=t.gl,i=n.createBuffer();if(!i)throw this.fatal("Not enough memory to create an array buffer!");n.bindBuffer(n.ARRAY_BUFFER,i),n.bufferData(n.ARRAY_BUFFER,new Float32Array([0,0,0,1,1,0,1,1]),n.STATIC_DRAW),this.buff=i},e}(L);function C(t){var e="",r="";return-1!==t.indexOf("B")?r="location.y -= uniAspectRatio - 1.0;":-1!==t.indexOf("T")&&(r="location.y += uniAspectRatio - 1.0;"),-1!==t.indexOf("R")?e="location.x -= 1.0 / uniAspectRatio - 1.0;":-1!==t.indexOf("L")&&(e="location.x += 1.0 / uniAspectRatio - 1.0;"),"uniform float uniAspectRatio;\nattribute vec2 attXY;\nvarying vec2 varUV;\n\nvoid main() {\n  varUV = attXY;\n  vec2 location = 2.0 * (attXY - vec2(0.5, 0.5));\n\n  if (uniAspectRatio > 1.0) {\n    location.y *= uniAspectRatio;"+r+"\n  } else {\n    location.x /= uniAspectRatio;"+e+"\n  }\n\n  gl_Position = vec4(location.x, -location.y, 0.9999999, 1.0);\n}"}var I="precision mediump float;\nuniform sampler2D uniTexture;\nvarying vec2 varUV;\n\nvoid main() {\n  vec4 color = texture2D( uniTexture, varUV );\n  gl_FragColor = color;\n}",D=["#RGB".length,"#RGBA".length,"#RRGGBB".length,"#RRGGBBAA".length],N=/^#[0-9A-F]+$/gi,G=function(){function t(t){void 0===t&&(t="#000000"),this.R=0,this.G=0,this.B=0,this.H=0,this.S=0,this.L=0,this.A=1,this.parse(t)}return t.isValid=function(t){var e,r;if(N.lastIndex=-1,!N.test(t))return!1;try{for(var n=Object(v.f)(D),i=n.next();!i.done;i=n.next()){var o=i.value;if(t.length===o)return!0}}catch(a){e={error:a}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(e)throw e.error}}return!1},t.normalize=function(e){return new t(e).stringify()},t.luminance=function(e){return new t(e).luminance()},t.luminanceStep=function(e){return new t(e).luminanceStep()},t.fromArrayRGB=function(e){var r=Object(v.e)(e,3),n=r[0],i=r[1],o=r[2];return t.newRGB(n,i,o)},t.fromArrayRGBA=function(e){var r=Object(v.e)(e,4),n=r[0],i=r[1],o=r[2],a=r[3];return t.newRGBA(n,i,o,a)},t.mix=function(e,r,n){void 0===n&&(n=.5);var i=1-n;return t.newRGBA(n*r.R+i*e.R,n*r.G+i*e.G,n*r.B+i*e.B,n*r.A+i*e.A)},t.ramp=function(e,r){if(void 0===r&&(r=.5),0===e.length)return t.newBlack();if(1===e.length)return e[0];var n=e.length-1,i=Math.floor(r*n),o=e[i];if(i===n)return o;var a=e[i+1],s=i+r/n;return t.mix(o,a,s)},t.newBlack=function(){return t.newRGB(0,0,0)},t.newWhite=function(){return t.newRGB(1,1,1)},t.newRGB=function(e,r,n){var i=new t;return i.R=e,i.G=r,i.B=n,i.A=1,i},t.newRGBA=function(e,r,n,i){var o=new t;return o.R=e,o.G=r,o.B=n,o.A=i,o},t.prototype.toArrayRGB=function(){return[this.R,this.G,this.B]},t.prototype.toArrayRGBA=function(){return[this.R,this.G,this.B,this.A]},t.prototype.parse=function(t){void 0===t&&(t="#000000");var e=t.trim().toUpperCase();return!!this.parseHexa.call(this,e)||(!!this.parseRGB.call(this,e)||(!!this.parseRGBA.call(this,e)||!!this.parseHSL.call(this,e)))},t.prototype.luminance=function(){return.2126*this.R+.7152*this.G+.0722*this.B},t.prototype.luminanceStep=function(){return this.luminance()<.6?0:1},t.prototype.stringify=function(){var t=Z(255*this.R)+Z(255*this.G)+Z(255*this.B);return this.A<1&&(t+=Z(255*this.A)),"#"+t},t.prototype.copy=function(){var e=new t;return e.R=this.R,e.G=this.G,e.B=this.B,e.A=this.A,e.H=this.H,e.S=this.S,e.L=this.L,e},t.prototype.hsl2rgb=function(){var t=6*this.H,e=this.S,r=this.L,n=(1-Math.abs(2*r-1))*e,i=n*(1-Math.abs(t%2-1)),o=0,a=0,s=0;t<3?t<1?(o=n,a=i,s=0):t<2?(o=i,a=n,s=0):(o=0,a=n,s=i):t<4?(o=0,a=i,s=n):t<5?(o=i,a=0,s=n):(o=n,a=0,s=i);var c=r-.5*n;this.R=o+c,this.G=a+c,this.B=s+c},t.prototype.rgb2hsl=function(){var t=this.R,e=this.G,r=this.B,n=Math.min(t,e,r),i=Math.max(t,e,r),o=i-n;this.L=.5*(i+n),o<1e-6?(this.H=0,this.S=0):(this.S=o/(1-Math.abs(2*this.L-1)),this.H=i===t?e>=r?X*((e-r)/o):1-X*((r-e)/o):i===e?X*(2+(r-t)/o):X*(4+(t-e)/o))},t.prototype.parseHexa=function(t){if("#"!==t.charAt(0))return!1;var e=0,r=0,n=0,i=1;switch(t.length){case 4:e=parseInt(t.charAt(1),16)*Y,r=parseInt(t.charAt(2),16)*Y,n=parseInt(t.charAt(3),16)*Y;break;case 5:e=parseInt(t.charAt(1),16)*Y,r=parseInt(t.charAt(2),16)*Y,n=parseInt(t.charAt(3),16)*Y,i=parseInt(t.charAt(4),16)*Y;break;case 7:e=parseInt(t.substr(1,2),16)*z,r=parseInt(t.substr(3,2),16)*z,n=parseInt(t.substr(5,2),16)*z;break;case 9:e=parseInt(t.substr(1,2),16)*z,r=parseInt(t.substr(3,2),16)*z,n=parseInt(t.substr(5,2),16)*z,i=parseInt(t.substr(7,2),16)*z}return isNaN(e)||isNaN(r)||isNaN(n)||isNaN(i)?this.R=this.G=this.B=this.A=0:(this.R=e,this.G=r,this.B=n,this.A=i),!0},t.prototype.parseRGB=function(t){var e=H.exec(t);return!!e&&(this.R=q(parseInt(e[1],10)*z),this.G=q(parseInt(e[2],10)*z),this.B=q(parseInt(e[3],10)*z),this.A=1,!0)},t.prototype.parseRGBA=function(t){var e=W.exec(t);return!!e&&(this.R=q(parseInt(e[1],10)*z),this.G=q(parseInt(e[2],10)*z),this.B=q(parseInt(e[3],10)*z),this.A=q(parseFloat(e[4])),!0)},t.prototype.parseHSL=function(t){var e=$.exec(t);return!!e&&(this.H=q(parseInt(e[1],10)*k),this.S=q(parseInt(e[2],10)*V),this.L=q(parseInt(e[3],10)*V),this.A=1,this.hsl2rgb(),!0)},t}(),X=1/6,Y=1/15,V=1/99,z=1/255,k=1/359,H=/^RGB[\s(]+([0-9]+)[^0-9]+([0-9]+)[^0-9]+([0-9]+)/,W=/^RGBA[\s(]+([0-9]+)[^0-9]+([0-9]+)[^0-9]+([0-9]+)[^0-9.]+([0-9.]+)/,$=/^HSL[\s(]+([0-9]+)[^0-9]+([0-9]+)[^0-9]+([0-9]+)/;function q(t){return t<0?0:t>1?1:t}function Z(t){var e=Math.floor(t).toString(16);return e.length<2&&(e="0"+e),e}var J=function(t){function e(e){var r=t.call(this)||this;return r.params=e,r._red=.8,r._green=.4,r._blue=.2,r._alpha=1,r}return Object(v.c)(e,t),Object.defineProperty(e.prototype,"red",{get:function(){return this._red},set:function(t){this._red=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"green",{get:function(){return this._green},set:function(t){this._green=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"blue",{get:function(){return this._blue},set:function(t){this._blue=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"alpha",{get:function(){return this._alpha},set:function(t){this._alpha=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"color",{get:function(){var t=new G;return t.R=this._red,t.G=this._green,t.B=this._blue,t.A=this._alpha,t.stringify()},set:function(t){var e=new G(t);this._red=e.R,this._green=e.G,this._blue=e.B,this._alpha=e.A},enumerable:!0,configurable:!0}),e.prototype.render=function(){var t=this.scene;if(t){var e=t.gl;e.clearColor(this._red,this._green,this._blue,this._alpha),e.clear(e.COLOR_BUFFER_BIT)}},e.prototype.initialize=function(){this.params&&(this.color=this.params.color||"#d72")},e.prototype.destroy=function(){},e}(L),K=function(){function t(t,e,r,n){this.$index=-1,this.extra={},this._id=t,this._data=e,this._update=r,this._destroy=n}return Object.defineProperty(t.prototype,"id",{get:function(){return this._id},enumerable:!0,configurable:!0}),t.prototype.destroy=function(){this._destroy(this)},t}(),Q=function(t){function e(e,r,n,i,o){var a=t.call(this,e,r,n,i)||this;return a._params=o,a}return Object(v.c)(e,t),e.prototype.update=function(t){t&&(this._params=Object(v.a)(Object(v.a)({},this._params),t));var e=this._params,r=e.xTL,n=e.yTL,i=e.zTL,o=e.uTL,a=e.vTL,s=e.xTR,c=e.yTR,u=e.zTR,f=e.uTR,h=e.vTR,l=e.xBR,p=e.yBR,d=e.zBR,m=e.uBR,g=e.vBR,y=e.xBL,b=e.yBL,_=e.zBL,A=e.uBL,w=e.vBL,R=this._data;R[0]=r,R[1]=n,R[2]=i,R[3]=o,R[4]=a,R[5]=s,R[6]=c,R[7]=u,R[8]=f,R[9]=h,R[10]=l,R[11]=p,R[12]=d,R[13]=m,R[14]=g,R[15]=y,R[16]=b,R[17]=_,R[18]=A,R[19]=w,this._update(this,R)},e}(K),tt=function(t){function e(e,r,n,i,o){var a=t.call(this,e,r,n,i)||this;return a._params=o,a}return Object(v.c)(e,t),Object.defineProperty(e.prototype,"x",{get:function(){return this._params.x},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"y",{get:function(){return this._params.y},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"z",{get:function(){return this._params.z},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"width",{get:function(){return this._params.width},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this._params.height},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"originX",{get:function(){return this._params.originX},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"originY",{get:function(){return this._params.originY},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"u0",{get:function(){return this._params.u0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"v0",{get:function(){return this._params.v0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"u1",{get:function(){return this._params.u1},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"v1",{get:function(){return this._params.v1},enumerable:!0,configurable:!0}),e.prototype.update=function(t){t&&(this._params=Object(v.a)(Object(v.a)({},this._params),t));var e=this._params,r=e.x,n=e.y,i=e.z,o=e.originX,a=e.originY,s=e.width,c=e.height,u=e.u0,f=e.v0,h=e.u1,l=e.v1,p=e.scale,d=e.angle,m=-o,g=-a,y=m+s,b=g,_=m+s,A=g+c,R=m,E=g+c,T=m*p,B=g*p,x=y*p,O=b*p,S=_*p,U=A*p,M=R*p,P=E*p;if(0!==(0|d)){var j=w.cos(d),L=w.sin(d);T=(m*j+g*L)*p,B=(g*j-m*L)*p,x=(y*j+b*L)*p,O=(b*j-y*L)*p,S=(_*j+A*L)*p,U=(A*j-_*L)*p,M=(R*j+E*L)*p,P=(E*j-R*L)*p}var F=this._data;F[0]=T+r,F[1]=B+n,F[2]=i,F[3]=u,F[4]=l,F[5]=x+r,F[6]=O+n,F[7]=i,F[8]=h,F[9]=l,F[10]=S+r,F[11]=U+n,F[12]=i,F[13]=h,F[14]=f,F[15]=M+r,F[16]=P+n,F[17]=i,F[18]=u,F[19]=f,this._update(this,F)},e}(K),et=1,rt=function(t){function e(e){var r=t.call(this)||this;return r._capacity=64,r._dataVert=new Float32Array(1280),r._sprites=[],r._update=function(t,e){r.scene?(t.$index<0&&r._allocate(t),r._dataVert.set(e,20*t.$index)):r._deferedSpritesUpdate.set(t.id,[t,e])},r._destroy=function(t){var e=r._sprites.pop();e?(e.$index!==t.$index&&(e.$index=t.$index,r._sprites[e.$index]=e,e.update()),t.$index=-1):console.error("You tried to destroy a Sprite that is not owned by this painter!",t)},r._atlas=e.atlas,r._camera=e.camera,r._deferedSpritesUpdate=new Map,r}return Object(v.c)(e,t),Object.defineProperty(e.prototype,"atlas",{get:function(){return this._atlas},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"count",{get:function(){return this._sprites.length},enumerable:!0,configurable:!0}),e.prototype.createSprite=function(t){var e=this.atlas,r=e.width||64,n=e.height||64,i=new Float32Array(20),o=new tt(""+et++,i,this._update,this._destroy,Object(v.a)({x:0,y:0,z:0,width:r,height:n,originX:.5*r,originY:.5*r,u0:0,v0:0,u1:1,v1:1,scale:1,angle:0},t));return o.update(),o},e.prototype.createQuad=function(t){var e=new Float32Array(20),r=new Q(""+et++,e,this._update,this._destroy,Object(v.a)({xTL:0,yTL:0,zTL:0,uTL:0,vTL:0,xTR:1024,yTR:0,zTR:0,uTR:1,vTR:0,xBR:1024,yBR:1024,zBR:0,uBR:1,vBR:1,xBL:0,yBL:1024,zBL:0,uBL:0,vBL:1},t));return r.update(),r},e.prototype._allocate=function(t){this._capacity<=this.count&&this._allocateNewBlock(),t.$index=this.count,this._sprites.push(t)},e.prototype._allocateNewBlock=function(){this._capacity+=64;var t=this.scene,e=this._buffElem;if(!t)throw Error("No scene!");if(!e)throw Error("No buffElem!");var r=t.gl;r.bindBuffer(r.ELEMENT_ARRAY_BUFFER,e),r.bufferData(r.ELEMENT_ARRAY_BUFFER,nt(this._capacity),r.DYNAMIC_DRAW);var n=new Float32Array(20*this._capacity);n.set(this._dataVert),this._dataVert=n},e.prototype.render=function(t,e){var r=this,n=r.scene,i=r._prg,o=r.atlas,a=r._buffVert,s=r._buffElem,c=r._camera;if(n&&i&&o&&a&&s){var u=n.gl;u.bindBuffer(u.ARRAY_BUFFER,a),u.bufferData(u.ARRAY_BUFFER,this._dataVert,u.DYNAMIC_DRAW),u.enable(u.DEPTH_TEST),i.use(),c.setUniformValues(i,n.width,n.height,t,e),o.activate(),i.$uniTexture=0,i.bindAttribs(a,"attXYZ","attUV"),u.bindBuffer(u.ARRAY_BUFFER,a),u.bindBuffer(u.ELEMENT_ARRAY_BUFFER,s),u.drawElements(u.TRIANGLES,6*this.count,u.UNSIGNED_SHORT,0)}},e.prototype.initialize=function(t){this._prg=this.createProgram({vert:"attribute vec3 attXYZ;\nattribute vec2 attUV;\n\nvarying vec2 varUV;\n\n#include cameraUniforms\n#include cameraFunction\n\nvoid main() {\n  varUV = attUV;\n  gl_Position = worldPointToScreen(attXYZ);\n}\n",frag:"precision mediump float;\nuniform sampler2D uniTexture;\nvarying vec2 varUV;\n\nvoid main() {\n  vec4 color = texture2D( uniTexture, varUV );\n  if (color.a < 1.0) discard;\n  gl_FragColor = color;\n}\n"},this._camera.getShaderIncludes());var e=t.gl,r=e.createBuffer();if(!r)throw this.fatal("Not enough memory to create an array buffer!");e.bindBuffer(e.ARRAY_BUFFER,r),e.bufferData(e.ARRAY_BUFFER,this._dataVert,e.DYNAMIC_DRAW),this._buffVert=r;var n=e.createBuffer();if(!n)throw this.fatal("Not enough memory to create an array buffer!");e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,n),e.bufferData(e.ELEMENT_ARRAY_BUFFER,nt(64),e.DYNAMIC_DRAW),this._buffElem=n,this.manageDeferedSpritesUpdates()},e.prototype.destroy=function(){var t=this.scene,e=this._buffVert,r=this._buffElem;if(t&&e&&r){var n=t.gl;n.deleteBuffer(e),n.deleteBuffer(r)}},e.prototype.manageDeferedSpritesUpdates=function(){var t,e;if(0!==this._deferedSpritesUpdate.size)try{for(var r=Object(v.f)(this._deferedSpritesUpdate.values()),n=r.next();!n.done;n=r.next()){var i=n.value,o=Object(v.e)(i,2),a=o[0],s=o[1];this._update(a,s)}}catch(c){t={error:c}}finally{try{n&&!n.done&&(e=r.return)&&e.call(r)}finally{if(t)throw t.error}}},e}(L);function nt(t){for(var e=new Uint16Array(6*t),r=0,n=0,i=0;i<t;i++){var o=n+1,a=n+2,s=n+3;e[r+0]=n,e[r+1]=s,e[r+2]=o,e[r+3]=o,e[r+4]=s,e[r+5]=a,n+=4,r+=6}return e}function it(t){for(var e=[],r=0;r<3*t;r++)e.push(Math.random());return e}var ot={Background:F,Clear:J,Painter:L,Sprites:rt,Voronoi:function(t){function e(e){var r=t.call(this)||this;if(r.params=Object(v.a)({seeds:it(20),colors:it(20),border:0,light:0,scaleX:1,scaleY:1},e),r.params.seeds.length%3!==0)throw Error('The length of "seeds" must be an integral multiple of 3!');if(r.params.seeds.length!==r.params.colors.length)throw Error('"seeds" and "colors" must have the same length!');return r.seeds=new Float32Array(r.params.seeds),r.colors=new Float32Array(r.params.colors),r}return Object(v.c)(e,t),e.prototype.render=function(){var t=this.scene,e=this.prg,r=this.buff;if(t&&e&&r){var n=this.params,i=n.border,o=n.scaleX,a=n.scaleY,s=i,c=t.gl;c.enable(c.DEPTH_TEST),e.use(),e.setUniform("uniSeeds",this.seeds),e.setUniform("uniColors",this.colors),e.setUniform("uniLight",this.params.light),e.setUniform("uniThickness",s),e.setUniform("uniScaleX",o),e.setUniform("uniScaleY",a),e.bindAttribs(r,"attXY"),c.bindBuffer(c.ARRAY_BUFFER,r),c.drawArrays(c.TRIANGLE_STRIP,0,4)}},e.prototype.destroy=function(t){var e=t.gl,r=this.buff;r&&e.deleteBuffer(r)},e.prototype.initialize=function(t){this.prg=this.createProgram({frag:'precision mediump float;\n\n#include "count"\n\nconst vec3 WHITE = vec3(1,1,1);\nconst vec3 BLACK = vec3(0,0,0);\n\nuniform float uniSeeds[COUNT];\nuniform float uniColors[COUNT];\nuniform float uniLight;\nuniform float uniThickness;\n\n/**\n * The coords of a and b must be in the range [0;1].\n */\nfloat distSquared(vec2 a, vec2 b) {\n  float x = abs(a.x - b.x);\n  if (x > .5) x = 1.0 - x;\n  float y = abs(a.y - b.y);\n  if (y > .5) y = 1.0 - y;\n\n  return x*x + y*y;\n}\n\nvarying vec2 varUV;\n\nvoid main() {\n  vec2 M = vec2(fract(varUV.x), fract(varUV.y));\n\n  float distA = distSquared(M, vec2(uniSeeds[0], uniSeeds[1])) * uniSeeds[2];\n  vec3 seedA = vec3(uniSeeds[0], uniSeeds[1], uniSeeds[2]);\n  vec3 colorA = vec3(uniColors[0], uniColors[1], uniColors[2]);\n  float distB = distSquared(M, vec2(uniSeeds[3], uniSeeds[4])) * uniSeeds[5];\n  vec3 seedB = vec3(uniSeeds[3], uniSeeds[4], uniSeeds[5]);\n  vec3 colorB = vec3(uniColors[3], uniColors[4], uniColors[5]);\n\n  if (distB < distA) {\n    float swaperDist = distA;\n    distA = distB;\n    distB = swaperDist;\n    vec3 swaperSeed = seedA;\n    seedA = seedB;\n    seedB = swaperSeed;\n    vec3 swaperColor = colorA;\n    colorA = colorB;\n    colorB = swaperColor;\n  }\n\n  float dist;\n  vec3 seed;\n  vec3 color;\n\n  for (int i = 6; i < COUNT; i+=3) {\n    seed = vec3(uniSeeds[i], uniSeeds[i+1], uniSeeds[i+2]);\n    color = vec3(uniColors[i], uniColors[i+1], uniColors[i+2]);\n    dist = distSquared(M, seed.xy) * seed.z;\n    if (dist < distA) {\n      distB = distA;\n      seedB = seedA;\n      colorB = colorA;\n      distA = dist;\n      seedA = seed;\n      colorA = color;\n    }\n    else if (dist < distB) {\n      distB = dist;\n      seedB = seed;\n      colorB = color;\n    }\n  }\n\n/*\n  vec2 AM = M.xy - seedA.xy;\n  vec2 AB = seedB.xy - seedA.xy;\n  vec2 AB1 = normalize(AB);\n  float semiLengthAB = length(AB) * 0.5;\n  float distanceFromBorder = semiLengthAB - dot(AM, AB1);\n*/\n\n  float dA = distA;\n  float dB = distB;\n  float distanceFromBorder = dB - dA;\n  float alpha;\n  vec3 color0;\n  vec3 color1;\n\n  if (distanceFromBorder < uniThickness) {\n      // Border.\n      color0 = BLACK;\n      color1 = colorA;\n      alpha = smoothstep(0.0, uniThickness, distanceFromBorder);\n  } else {\n      // Cell.\n      color0 = colorA;\n      color1 = mix(colorA, WHITE, uniLight);\n      alpha = (distanceFromBorder - uniThickness) / (dB - uniThickness);\n  }\n\n  gl_FragColor = vec4(mix(color0, color1, alpha), 1);\n}\n',vert:"uniform float uniScaleX;\nuniform float uniScaleY;\n\nattribute vec2 attXY;\nvarying vec2 varUV;\n\nvoid main() {\n  varUV = vec2(attXY.x * uniScaleX, attXY.y * uniScaleY);\n  float x = (attXY.x * 2.0) - 1.0;\n  float y = 1.0 - (attXY.y * 2.0);\n  gl_Position = vec4(x, y, 0.0, 1.0);\n}\n"},{count:"const int COUNT = "+this.params.seeds.length+";"});var e=t.gl,r=e.createBuffer();if(!r)throw this.fatal("Not enough memory to create an array buffer!");e.bindBuffer(e.ARRAY_BUFFER,r),e.bufferData(e.ARRAY_BUFFER,new Float32Array([0,0,0,1,1,0,1,1]),e.STATIC_DRAW),this.buff=r},e}(L)},at=function(){function t(t,e){this.gl=t,this._name=e,this._ready=!1,this._width=0,this._height=0;var r=t.createTexture();if(!r)throw new Error("Unable to create a new texture!");this.texture=r,t.bindTexture(t.TEXTURE_2D,r),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.LINEAR)}return Object.defineProperty(t.prototype,"name",{get:function(){return this._name},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"width",{get:function(){return this._width},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this._height},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"ready",{get:function(){return this._ready},enumerable:!0,configurable:!0}),t.prototype.destroy=function(){this._ready=!1;var t=this.gl,e=this.texture;t.deleteTexture(e)},t.prototype.activate=function(t){void 0===t&&(t=0);var e=this.gl,r=this.texture,n=[e.TEXTURE0,e.TEXTURE1,e.TEXTURE2,e.TEXTURE3,e.TEXTURE4,e.TEXTURE5,e.TEXTURE6,e.TEXTURE7];e.activeTexture(n[Math.abs(t)%n.length]),e.bindTexture(e.TEXTURE_2D,r)},t.prototype.refresh=function(){return Object(v.b)(this,void 0,void 0,(function(){return Object(v.d)(this,(function(t){switch(t.label){case 0:return this._params?[4,this.load(this._params)]:[2];case 1:return t.sent(),[2]}}))}))},t.prototype.load=function(t){return Object(v.b)(this,void 0,void 0,(function(){return Object(v.d)(this,(function(e){return this._ready=!1,this._params=t,t.image?[2,this.loadImage(t.image)]:t.canvas?[2,this.loadCanvas(t.canvas)]:[2]}))}))},t.prototype.loadImage=function(t){return Object(v.b)(this,void 0,void 0,(function(){var e;return Object(v.d)(this,(function(r){return e=this,[2,new Promise((function(r,n){var i=new Image;e._ready=!1,i.onload=function(){var t=e.gl,n=e.texture;t.bindTexture(t.TEXTURE_2D,n),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,i),e._ready=!0,e._width=i.width,e._height=i.height,r()},i.onerror=function(){console.error('Unable to load image "'+name+'": ',t),n()},i.src=t}))]}))}))},t.prototype.loadCanvas=function(t){var e=this.gl,r=this.texture;e.bindTexture(e.TEXTURE_2D,r),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,t),this._ready=!0,this._width=t.width,this._height=t.height},t}(),st=function(){function t(t){var e=this;this._x=0,this._y=0,this._down=!1,this._downTime=0,this._eventDown=!1,this._eventUp=!1,this.onMouseMove=function(t){e.computeCoords(t.clientX,t.clientY)},this.onTouchMove=function(t){var r=t.touches[0];e.computeCoords(r.clientX,r.clientY)},this.onMouseDown=function(t){e.onDown(t.clientX,t.clientY)},this.onTouchStart=function(t){var r=t.touches[0];e.onDown(r.clientX,r.clientY)},this.onMouseUp=function(t){e.onUp(t.clientX,t.clientY)},this.onTouchEnd=function(t){var r=t.touches[0];e.onUp(r.clientX,r.clientY)},this.canvas=t,window.addEventListener("mousemove",this.onMouseMove,!0),window.addEventListener("touchmove",this.onTouchMove,!0),window.addEventListener("mousedown",this.onMouseDown,!0),window.addEventListener("touchstart",this.onTouchStart,!0),window.addEventListener("mouseup",this.onMouseUp,!0),window.addEventListener("touchend",this.onTouchEnd,!0)}return t.prototype.reset=function(){this._eventDown=!1,this._eventUp=!1},Object.defineProperty(t.prototype,"x",{get:function(){return this._x},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"y",{get:function(){return this._y},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"down",{get:function(){return this._down},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"eventUp",{get:function(){return this._eventUp},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"eventDown",{get:function(){return this._eventDown},enumerable:!0,configurable:!0}),t.prototype.onDown=function(t,e){0===this._downTime&&(this.computeCoords(t,e),this._down=!0,this._eventDown=!0,this._downTime=Date.now())},t.prototype.onUp=function(t,e){0!==this._downTime&&(this.computeCoords(t,e),this._down=!1,this._eventUp=!0,this._downTime=0)},t.prototype.computeCoords=function(t,e){var r=this.canvas.getBoundingClientRect(),n=t-r.left,i=e-r.top,o=r.width,a=r.height;o>a?(this._x=1024*n/o,this._y=1024*(.5*(1-a/o)+i/o)):(this._x=1024*(.5*(1-o/a)+n/a),this._y=1024*i/a)},t}(),ct=1,ut=function(){function t(t){var e=this;this.resolution=1,this.onAnimation=null,this.activePainters=[],this.isRendering=!1,this.lastRenderingTime=0,this.render=function(t){var r,n;if(e.isRendering){window.requestAnimationFrame(e.render);var i=e,o=i.gl,a=i.lastRenderingTime;!function(t,e){void 0===e&&(e=0);var r=e<=0?window.devicePixelRatio:e,n=t.canvas;if(n instanceof HTMLCanvasElement){var i=Math.floor(n.clientWidth*r),o=Math.floor(n.clientHeight*r);if(n.width!==i||n.height!==o)return n.width=i,n.height=o,t.viewport(0,0,i,o),!0}}(o,e.resolution),e.lastRenderingTime=t;var s=t-a;o.clearDepth(1),o.clear(o.DEPTH_BUFFER_BIT),o.depthFunc(o.LESS);try{try{for(var c=Object(v.f)(e.activePainters),u=c.next();!u.done;u=c.next()){u.value.render(t,s)}}catch(h){r={error:h}}finally{try{u&&!u.done&&(n=c.return)&&n.call(c)}finally{if(r)throw r.error}}var f=e.onAnimation;"function"===typeof f&&(f(t),e.pointer.reset())}catch(l){console.error(l),e.stop(),console.error("###############################"),console.error("# Rendering has been stopped! #"),console.error("###############################")}}},this._pointer=new st(t);var r=t.getContext("webgl",{});if(!r)throw new Error("Unable to create a WegGL context!");this._gl=r,this.atlases=new Map}return Object.defineProperty(t.prototype,"gl",{get:function(){return this._gl},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"pointer",{get:function(){return this._pointer},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"width",{get:function(){return this.gl.drawingBufferWidth},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this.gl.drawingBufferHeight},enumerable:!0,configurable:!0}),t.prototype.use=function(t){var e,r;try{for(var n=Object(v.f)(t),i=n.next();!i.done;i=n.next()){i.value.scene=this}}catch(o){e={error:o}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(e)throw e.error}}this.activePainters=t.slice()},t.prototype.getAtlas=function(t){return this.atlases.get(t)||null},t.prototype.createAtlas=function(t,e){var r=t.name||this.getNewName(),n=new at(this.gl,r);return this.atlases.set(r,n),n.load(t).then((function(){"function"===typeof e&&e(t)})),n},t.prototype.createAtlasAsync=function(t){var e=this;return new Promise((function(r){var n=t.name||e.getNewName(),i=new at(e.gl,n);e.atlases.set(n,i),i.load(t).then((function(){return r(i)}))}))},t.prototype.createAtlasesAsync=function(t){var e=this;return new Promise((function(r){var n,i,o=Object.keys(t),a=[];try{for(var s=Object(v.f)(o),c=s.next();!c.done;c=s.next()){var u=c.value,f=t[u];a.push(e.createAtlasAsync(f))}}catch(h){n={error:h}}finally{try{c&&!c.done&&(i=s.return)&&i.call(s)}finally{if(n)throw n.error}}Promise.all(a).then((function(t){for(var e={},n=0;n<t.length;n++){var i=o[n],a=t[n];e[i]=a}r(e)}))}))},t.prototype.destroyAtlas=function(t){var e=this.atlases,r=e.get(t);return!!r&&(e.delete(t),r.destroy(),!0)},t.prototype.start=function(){this.isRendering||(this.isRendering=!0,window.requestAnimationFrame(this.render))},t.prototype.stop=function(){this.isRendering=!1},t.prototype.getNewName=function(){for(;;){var t="atlas-"+ct++;if(!this.atlases.has(t))return t}},t}(),ft=(function(t){function e(){return null!==t&&t.apply(this,arguments)||this}Object(v.c)(e,t)}(ut),{Calc:w,Camera:B,Painter:ot,Scene:ut}),ht=r(13),lt={rnd:function(t,e){"undefined"===typeof e&&(e=t,t=0);return Math.floor(t+(e-t)*Math.random())},rndVector2D:function(){var t=2*Math.PI*Math.random();return[Math.cos(t),Math.sin(t)]}};var pt=function(){function t(e,r){Object(h.a)(this,t),this.dataLevel=e,this.painter=r,this.rows=void 0,this.cols=void 0;var n=e.data;this.rows=n.length,this.cols=n.reduce((function(t,e){return e.length>t.length?e:t}),"").length,this.createFixedSprites()}return Object(l.a)(t,[{key:"getIsometricCoords",value:function(t,e){return{x:64*(e-t),y:21*(e+t),z:(e+t)/1024}}},{key:"createFixedSprites",value:function(){var t=this;this.forEachCell((function(e,r,n){switch(n){case dt:return t.addWallSprite(e,r)}}))}},{key:"addWallSprite",value:function(t,e){var r=this.painter,n=lt.rnd(8)/8,i=Object(ht.a)({},this.getIsometricCoords(t,e),{width:128,height:128,originX:64,originY:96,u0:n,u1:n+1/8,v0:0,v1:1/8,angle:0,scale:1});r.createSprite(i)}},{key:"forEachCell",value:function(t){for(var e=this.dataLevel.data,r=0;r<e.length;r++)for(var n=e[r],i=0;i<n.length;i++)t(r,i,n.charAt(i))}},{key:"name",get:function(){return this.dataLevel.name}}]),t}(),dt="#",mt={Introduction:{name:"Gentle Introduction",data:["####################","#                | #","# ############## + #","#k               | X","######-+-###########","# | #         #k   #","# O #####-O-# #### #","#1|         #      #","####################"]}},vt=r(5),gt=r.n(vt),yt=(r(21),function(t){function e(){var t,r;Object(h.a)(this,e);for(var n=arguments.length,o=new Array(n),a=0;a<n;a++)o[a]=arguments[a];return(r=Object(p.a)(this,(t=Object(d.a)(e)).call.apply(t,[this].concat(o)))).refCanvas1=i.a.createRef(),r.state={},r}return Object(m.a)(e,t),Object(l.a)(e,[{key:"componentDidMount",value:function(){var t=Object(f.a)(c.a.mark((function t(){var e,r,n,i,o,a,s,f,h,l,p,d;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e=this.refCanvas1.current){t.next=3;break}return t.abrupt("return");case 3:return r=new ft.Scene(e),t.next=6,r.createAtlasAsync({image:gt.a});case 6:n=t.sent,console.log("LevelAtlas:",gt.a),i=new ft.Camera.Cover2D({size:1024}),console.log("camera:",i),o=new ft.Painter.Sprites({atlas:n,camera:i}),a=new pt(mt.Introduction,o),s=lt.rnd(a.cols),f=lt.rnd(a.rows),h=lt.rndVector2D(),l=Object(u.a)(h,2),p=l[0],d=l[1],.05,r.onAnimation=function(t){var e=a.getIsometricCoords(f,s);i.x=e.x,i.y=e.y,s+=.05*p,(f+=.05*d)<0?(d=-d,f=0):f>a.rows-1&&(d=-d,f=a.rows-1),s<0?(p=-p,s=0):s>a.cols-1&&(p=-p,s=a.cols-1)},r.use([o]),r.start();case 19:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"render",value:function(){return i.a.createElement("div",{className:"App"},i.a.createElement("canvas",{ref:this.refCanvas1}))}}]),e}(i.a.Component));Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));a.a.render(i.a.createElement(yt,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(t){t.unregister()})).catch((function(t){console.error(t.message)}))},5:function(t,e,r){t.exports=r.p+"static/media/atlas-level.9c78bf05.png"}},[[14,1,2]]]);
//# sourceMappingURL=main.b53edc18.chunk.js.map